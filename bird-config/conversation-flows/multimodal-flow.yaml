# ğŸ­ Flujo Conversacional Multimodal - RobertAI
# Procesamiento Inteligente de ImÃ¡genes, Audio y Documentos
# VersiÃ³n: 1.0.0 | Fecha: 2025-09-04

flow_name: "intelligent_multimodal_processing"
flow_type: "core_functionality"
priority: "highest"
language: "es-LATAM"

# ========================================
# TRIGGERS DE ACTIVACIÃ“N
# ========================================
activation_triggers:
  media_received: 
    - "image_uploaded"
    - "audio_message_received"  
    - "document_uploaded"
    - "video_received"
  
  processing_requests:
    - "analizar imagen"
    - "transcribir audio"
    - "leer documento"
    - "Â¿quÃ© dice aquÃ­?"
    - "ayÃºdame con esto"

# ========================================
# ANÃLISIS AUTOMÃTICO DE CONTENIDO
# ========================================
content_analysis_system:
  
  # CLASIFICACIÃ“N AUTOMÃTICA
  automatic_classification:
    
    image_type_detection:
      document_images:
        patterns: ["text_heavy", "structured_layout", "official_format"]
        subtypes: 
          - "invoice_bill"
          - "contract_legal" 
          - "medical_prescription"
          - "identification_document"
          - "receipt_ticket"
          - "form_application"
        confidence_threshold: 0.85
        
      informational_images:
        patterns: ["menu", "screenshot", "informational_graphic"]
        subtypes:
          - "restaurant_menu"
          - "app_screenshot" 
          - "social_media_post"
          - "map_directions"
          - "product_catalog"
        processing_approach: "context_extraction_with_suggestions"
        
      personal_images:
        patterns: ["people", "events", "personal_moments"]
        privacy_handling: "high_privacy_mode"
        processing_limitation: "basic_description_only"
    
    audio_type_detection:
      voice_messages:
        characteristics: ["human_speech", "conversational_tone"]
        language_detection: ["spanish", "english", "mixed"]
        urgency_analysis: ["tone_of_voice", "speech_pace", "keywords"]
        
      recorded_content:
        characteristics: ["meeting", "lecture", "phone_call"]
        processing_complexity: "high_accuracy_transcription"
        
    document_type_detection:
      business_documents:
        types: ["contract", "invoice", "report", "presentation"]
        processing_priority: "data_extraction_focused"
        
      personal_documents:  
        types: ["certificate", "medical", "educational"]
        privacy_level: "maximum_confidentiality"

# ========================================
# PROCESAMIENTO DE IMÃGENES
# ========================================
image_processing_flows:
  
  # PROCESAMIENTO DE DOCUMENTOS (OCR)
  document_ocr_flow:
    
    step_1_initial_analysis:
      processing_message: |
        ğŸ“¸ **Analizando tu imagen...**
        
        ğŸ” Detectando texto y estructura...
        âš¡ Esto tomarÃ¡ solo unos segundos
        
      auto_detection_categories:
        - "factura_recibo"
        - "contrato_documento_legal" 
        - "receta_medica"
        - "identificacion_oficial"
        - "formulario_aplicacion"

    step_2_extraction_and_analysis:
      
      invoice_bill_processing:
        data_extraction:
          - "company_name"
          - "total_amount" 
          - "due_date"
          - "service_period"
          - "account_number"
          
        analysis_response: |
          ğŸ’° **Factura analizada:**
          
          ğŸ¢ **Empresa:** {company_name}
          ğŸ’µ **Monto:** ${total_amount}
          ğŸ“… **Vencimiento:** {due_date}
          ğŸ“‹ **Servicio:** {service_description}
          
          ğŸ’¡ **Â¿Te ayudo a:**
          â€¢ Programar recordatorio para pagar antes del vencimiento?
          â€¢ Agregar este gasto a tu tracking mensual?
          â€¢ Coordinar el mÃ©todo de pago?
          
        proactive_suggestions:
          - text: "â° Recordatorio de pago"
            action: "create_payment_reminder"
          - text: "ğŸ“Š Agregar a gastos"
            action: "add_to_expense_tracking"
          - text: "âœ… Solo guardar info"
            action: "save_document_info"
      
      contract_processing:
        critical_data_extraction:
          - "contract_parties"
          - "key_dates"
          - "important_amounts"
          - "obligations_responsibilities"
          - "termination_clauses"
          
        analysis_response: |
          ğŸ“‹ **Contrato analizado:**
          
          ğŸ‘¥ **Partes:** {contract_parties}
          ğŸ“… **Fechas clave:** {important_dates}
          ğŸ’° **Montos:** {financial_terms}
          
          âš ï¸ **Puntos importantes detectados:**
          {key_obligations}
          
          ğŸ’¡ **Â¿Quieres que:**
          â€¢ Programe recordatorios para fechas lÃ­mite?
          â€¢ Resuma los puntos mÃ¡s crÃ­ticos?
          â€¢ Identifique obligaciones pendientes?
          
      medical_prescription_processing:
        extraction_focus:
          - "doctor_name"
          - "patient_name"  
          - "medications_prescribed"
          - "dosage_instructions"
          - "treatment_duration"
          
        analysis_response: |
          ğŸ’Š **Receta mÃ©dica procesada:**
          
          ğŸ‘¨â€âš•ï¸ **Doctor:** {doctor_name}
          ğŸ’Š **Medicamentos:** {medication_list}
          â° **Horarios:** {dosage_schedule}
          ğŸ“… **DuraciÃ³n:** {treatment_period}
          
          ğŸ’¡ **Â¿Te ayudo a:**
          â€¢ Programar recordatorios para tomar medicamentos?
          â€¢ Agendar cita de seguimiento con el doctor?
          â€¢ Recordarte comprar los medicamentos?
          
        privacy_note: "InformaciÃ³n mÃ©dica manejada con mÃ¡xima confidencialidad"

  # PROCESAMIENTO DE MENÃšS Y CONTENIDO INFORMACIONAL
  informational_content_flow:
    
    restaurant_menu_processing:
      content_extraction:
        - "restaurant_name"
        - "food_categories"
        - "dish_names_and_prices"
        - "special_offers"
        - "contact_information"
        
      analysis_response: |
        ğŸ½ï¸ **MenÃº analizado:**
        
        ğŸª **Restaurante:** {restaurant_name}
        
        **ğŸ”¥ Platillos destacados:**
        {featured_dishes_with_prices}
        
        **ğŸ’° Rango de precios:** {price_range}
        **ğŸ“ Contacto:** {contact_info}
        
        Â¿Te ayudo con algo?
        
      interaction_options:
        - text: "ğŸ½ï¸ Hacer reservaciÃ³n"
          action: "initiate_reservation_flow"
        - text: "ğŸ’° Ver opciones por presupuesto"
          action: "filter_by_budget"
        - text: "ğŸ“ UbicaciÃ³n y cÃ³mo llegar"
          action: "provide_location_info"

    screenshot_processing:
      context_analysis: "determine_screenshot_purpose_and_content"
      
      common_screenshot_types:
        conversation_screenshot:
          processing: "extract_key_information_and_context"
          response: |
            ğŸ’¬ **Screenshot de conversaciÃ³n:**
            
            ğŸ“ **InformaciÃ³n clave:** {extracted_info}
            
            Â¿Necesitas que te ayude con algo relacionado a este mensaje?
            
        app_interface_screenshot:
          processing: "identify_app_and_relevant_information"
          assistance_offer: "Â¿Te ayudo a entender algo especÃ­fico o hacer alguna acciÃ³n?"
          
        error_message_screenshot:
          processing: "identify_error_and_suggest_solutions"
          response: |
            âš ï¸ **Error detectado:**
            
            ğŸ” **Problema:** {error_description}
            ğŸ’¡ **Posibles soluciones:** {suggested_fixes}
            
            Â¿Quieres que te ayude paso a paso?

# ========================================
# PROCESAMIENTO DE AUDIO
# ========================================
audio_processing_flows:
  
  # TRANSCRIPCIÃ“N INTELIGENTE
  intelligent_transcription:
    
    step_1_audio_analysis:
      initial_processing: |
        ğŸµ **Procesando tu mensaje de voz...**
        
        ğŸ”„ Transcribiendo con precisiÃ³n 92%+
        ğŸ§  Analizando intenciÃ³n y contexto
        
      quality_assessment:
        - "audio_clarity_level"
        - "background_noise_detection"
        - "language_identification"
        - "urgency_tone_analysis"

    step_2_transcription_and_intent:
      
      standard_voice_message:
        transcription_display: |
          ğŸ“ **TranscripciÃ³n:**
          "{transcribed_text}"
          
          ğŸ§  **EntendÃ­ que necesitas:** {interpreted_intent}
          
          Â¿Es correcto? Â¿Procedo con eso?
          
        confidence_levels:
          high_confidence: "Proceed automatically with confirmation"
          medium_confidence: "Ask for verification before proceeding"
          low_confidence: "Request clarification or text alternative"
          
      complex_instructions_audio:
        multi_task_detection: "identify_multiple_requests_in_single_audio"
        
        breakdown_response: |
          ğŸ“‹ **Audio con mÃºltiples tareas procesado:**
          
          **ğŸ¯ DetectÃ© {task_count} tareas:**
          
          {task_breakdown_list}
          
          Â¿Procedo con todas o hay alguna especÃ­fica que prefieres primero?
          
        task_prioritization_options:
          - text: "âœ… Todas en orden"
            action: "process_all_tasks_sequentially"
          - text: "ğŸ¯ Solo la urgente"
            action: "identify_and_process_urgent_task"
          - text: "ğŸ“ DÃ©jame elegir"
            action: "present_individual_task_options"

    step_3_emotional_context_analysis:
      
      urgency_detection:
        high_urgency_indicators: ["fast_speech", "urgent_keywords", "stress_tone"]
        
        urgent_response: |
          ğŸš¨ **DetectÃ© urgencia en tu mensaje:**
          
          ğŸ“ **TranscripciÃ³n:** "{transcribed_text}"
          
          âš¡ **Te ayudo inmediatamente.**
          {immediate_action_plan}
          
      emotional_support:
        stress_frustration_detection: |
          ğŸ˜” **NotÃ© que suenas {detected_emotion}:**
          
          ğŸ“ **TranscripciÃ³n:** "{transcribed_text}"
          
          ğŸ’ª **Tranquilo, te ayudo paso a paso.**
          
          Â¿Por dÃ³nde empezamos?

# ========================================
# PROCESAMIENTO DE DOCUMENTOS
# ========================================
document_processing_flows:
  
  # ANÃLISIS DE PDFs
  pdf_document_analysis:
    
    step_1_document_classification:
      automatic_categorization:
        - "legal_contract"
        - "financial_statement"  
        - "medical_report"
        - "academic_document"
        - "business_report"
        - "government_form"
        
      classification_response: |
        ğŸ“„ **Documento PDF analizado:**
        
        ğŸ“‹ **Tipo:** {document_type}
        ğŸ“Š **PÃ¡ginas:** {page_count}
        ğŸ“ **Contenido principal:** {main_content_summary}
        
        Â¿QuÃ© necesitas especÃ­ficamente del documento?

    step_2_targeted_extraction:
      
      legal_contract_analysis:
        key_information_extraction:
          - "contract_date_and_duration"
          - "parties_involved"
          - "financial_obligations"
          - "key_deadlines"
          - "termination_clauses"
          
        analysis_output: |
          âš–ï¸ **AnÃ¡lisis de contrato:**
          
          **ğŸ“… Fechas importantes:**
          {critical_dates}
          
          **ğŸ’° Obligaciones financieras:**
          {financial_terms}
          
          **âš ï¸ ClÃ¡usulas crÃ­ticas:**
          {important_clauses}
          
          Â¿Quieres que programe recordatorios para las fechas importantes?
          
      financial_statement_analysis:
        data_extraction_focus:
          - "account_balances"
          - "income_expenses"
          - "important_transactions"
          - "payment_due_dates"
          
        financial_insights: |
          ğŸ’° **Estado financiero analizado:**
          
          **ğŸ’³ Saldos principales:**
          {account_summary}
          
          **ğŸ“ˆ Movimientos importantes:**
          {key_transactions}
          
          **âš ï¸ Fechas de pago prÃ³ximas:**
          {upcoming_payments}
          
          Â¿Te ayudo a organizar los pagos pendientes?

    step_3_actionable_recommendations:
      
      deadline_management:
        automatic_deadline_detection: "scan_for_dates_and_time_sensitive_items"
        
        deadline_alert: |
          â° **Fechas lÃ­mite detectadas:**
          
          {deadline_list_with_importance}
          
          ğŸ’¡ **Recomiendo programar recordatorios para:**
          {recommended_reminder_schedule}
          
      task_generation:
        document_based_tasks: |
          ğŸ“‹ **Tareas sugeridas basadas en el documento:**
          
          {suggested_action_items}
          
          Â¿Quieres que programe alguna de estas como recordatorio?

# ========================================
# RESPUESTAS CONTEXTUALES INTELIGENTES
# ========================================
contextual_response_system:
  
  # GENERACIÃ“N DE RESPUESTAS PERSONALIZADAS
  personalized_responses:
    
    user_context_consideration:
      historical_patterns: "consider_user_previous_similar_requests"
      current_situation: "factor_in_time_of_day_and_recent_interactions"
      preference_adaptation: "adjust_formality_and_detail_level"
      
    response_personalization: |
      {context_aware_greeting}
      
      {content_analysis_results}
      
      {personalized_suggestions_based_on_user_history}
      
      {call_to_action_matching_user_style}

  # SUGERENCIAS PROACTIVAS
  proactive_assistance:
    
    pattern_recognition:
      recurring_document_types: "Veo que procesaste varias facturas este mes, Â¿quieres que te ayude a organizarlas?"
      related_content_detection: "Esta imagen parece relacionada con tu cita mÃ©dica de maÃ±ana"
      opportunity_identification: "DetectÃ© informaciÃ³n que podrÃ­a ser Ãºtil para tu recordatorio pendiente"
      
    intelligent_suggestions: |
      ğŸ’¡ **Basado en lo que veo, te sugiero:**
      
      {contextual_suggestions_list}
      
      Â¿Alguna de estas opciones te es Ãºtil?

# ========================================
# MANEJO DE ERRORES Y CASOS ESPECIALES
# ========================================
error_handling_system:
  
  # CONTENIDO NO PROCESABLE
  unprocessable_content:
    
    poor_quality_media:
      image_issues:
        - "blurry_or_low_resolution"
        - "poor_lighting_conditions"
        - "text_too_small_to_read"
        - "partial_content_visible"
        
      quality_improvement_guidance: |
        ğŸ“¸ **La imagen estÃ¡ un poco borrosa para procesar Ã³ptimamente:**
        
        ğŸ’¡ **Para mejor resultado:**
        â€¢ AsegÃºrate de tener buena luz
        â€¢ MantÃ©n el telÃ©fono firme
        â€¢ Acerca la cÃ¡mara al texto
        â€¢ Toma la foto directamente (sin Ã¡ngulo)
        
        Â¿Puedes tomar otra foto o me dices quÃ© necesitas especÃ­ficamente?
        
      audio_issues:
        - "background_noise_too_high"
        - "audio_too_quiet"
        - "speech_too_fast_or_unclear"
        
      audio_improvement_guidance: |
        ğŸµ **Tu audio tiene mucho ruido de fondo:**
        
        ğŸ’¡ **Para mejor transcripciÃ³n:**
        â€¢ Graba en lugar mÃ¡s silencioso
        â€¢ Acerca el telÃ©fono a tu boca
        â€¢ Habla un poco mÃ¡s despacio
        â€¢ Evita lugares con eco
        
        Â¿Puedes enviar otro audio o me escribes lo que necesitas?

  # CONTENIDO SENSIBLE O PRIVADO
  privacy_protection:
    
    sensitive_content_detection:
      personal_information: "DetectÃ© informaciÃ³n personal sensible"
      financial_data: "Identifico datos financieros confidenciales" 
      medical_information: "Reconozco informaciÃ³n mÃ©dica privada"
      
    privacy_assurance: |
      ğŸ”’ **InformaciÃ³n sensible detectada:**
      
      Tu privacidad es mi prioridad mÃ¡xima:
      âœ… Esta informaciÃ³n se procesa de forma segura
      âœ… No se almacena permanentemente
      âœ… Solo tÃº y yo tenemos acceso
      âœ… Se elimina despuÃ©s de ayudarte
      
      Â¿Procedo con el anÃ¡lisis?
      
    privacy_options:
      - text: "âœ… SÃ­, proceder"
        action: "process_with_privacy_protection"
      - text: "ğŸ“ Solo info general"
        action: "basic_processing_only"
      - text: "âŒ Mejor no"
        action: "cancel_processing"

  # LIMITACIONES TÃ‰CNICAS
  technical_limitations:
    
    unsupported_formats:
      format_limitation_message: |
        ğŸ“ **Formato no soportado actualmente:**
        
        ğŸ” **RecibÃ­:** {file_format}
        âœ… **Formatos que manejo:** JPG, PNG, PDF, MP3, MP4, DOCX
        
        ğŸ’¡ **Â¿Puedes:**
        â€¢ Convertir a formato compatible?
        â€¢ Tomar screenshot si es contenido visual?
        â€¢ Describir quÃ© necesitas si no puedes cambiar formato?
        
    processing_timeout:
      timeout_recovery: |
        â° **El procesamiento estÃ¡ tomando mÃ¡s tiempo del esperado:**
        
        ğŸ”„ **Voy a intentar de nuevo con optimizaciÃ³n...**
        
        Si sigue tardando, Â¿puedes:
        â€¢ Describir quÃ© necesitas del archivo?
        â€¢ Enviar una versiÃ³n mÃ¡s pequeÃ±a?
        â€¢ Dividir en partes si es muy extenso?

# ========================================
# INTEGRACIÃ“N CON OTRAS FUNCIONALIDADES
# ========================================
functionality_integration:
  
  # CONEXIÃ“N CON RECORDATORIOS
  reminder_integration:
    
    automatic_reminder_creation:
      from_document_analysis: |
        ğŸ“… **Fechas importantes detectadas en tu documento:**
        
        {extracted_dates_with_context}
        
        Â¿Programo recordatorios automÃ¡ticamente?
        
      from_audio_instructions:
        voice_to_reminder: |
          â° **Tu audio incluÃ­a recordatorios:**
          
          {extracted_reminder_requests}
          
          Â¿Los programo asÃ­ o necesitas ajustar algo?

  # CONEXIÃ“N CON AGENDAMIENTO  
  scheduling_integration:
    
    appointment_information_extraction:
      from_medical_documents: "Extract doctor info and suggest appointment booking"
      from_service_receipts: "Identify service providers for future scheduling"
      from_business_cards: "Save contact info for meeting coordination"
      
    scheduling_suggestions: |
      ğŸ“… **DetectÃ© informaciÃ³n Ãºtil para agendar:**
      
      {extracted_contact_scheduling_info}
      
      Â¿Te ayudo a coordinar una cita?

# ========================================
# MÃ‰TRICAS Y OPTIMIZACIÃ“N
# ========================================
performance_optimization:
  
  # MÃ‰TRICAS DE PRECISIÃ“N
  accuracy_tracking:
    ocr_accuracy: "Track text extraction precision by document type"
    transcription_accuracy: "Monitor speech-to-text quality by language and accent"
    intent_recognition: "Measure how well we understand user needs from media"
    
  # OPTIMIZACIÃ“N CONTINUA
  continuous_improvement:
    error_pattern_analysis: "Identify common processing failures for improvement"
    user_satisfaction_tracking: "Monitor how helpful multimodal responses are"
    processing_speed_optimization: "Reduce time while maintaining quality"
    
  # ADAPTACIÃ“N PERSONALIZADA
  user_adaptation:
    content_type_preferences: "Learn which types of content user sends most"
    response_style_optimization: "Adapt detail level and tone based on feedback"
    proactive_suggestion_tuning: "Improve suggestions based on user acceptance rates"

# ========================================
# CONFIGURACIÃ“N AVANZADA
# ========================================
advanced_configuration:
  
  # CONFIGURACIÃ“N DE CALIDAD
  quality_settings:
    processing_modes:
      speed_optimized: "Fast processing with good accuracy"
      accuracy_optimized: "Slower processing with maximum precision"  
      balanced_mode: "Optimal balance of speed and accuracy"
      
  # CONFIGURACIÃ“N DE PRIVACIDAD
  privacy_settings:
    data_retention:
      temporary_processing: "Process and delete immediately"
      session_retention: "Keep during conversation only"
      user_controlled: "User decides retention period"
      
  # CONFIGURACIÃ“N DE RESPUESTA
  response_customization:
    detail_levels:
      minimal: "Basic analysis with essential information only"
      standard: "Comprehensive analysis with actionable suggestions"
      detailed: "Deep analysis with extensive context and options"
      
    interaction_styles:
      professional: "Formal tone with structured responses"
      casual: "Friendly tone with conversational responses"
      adaptive: "Adjust based on content type and user preference"

# Fin del flujo multimodal