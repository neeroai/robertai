# ğŸ“… Flujo Conversacional de Agendamiento - RobertAI
# Sistema Inteligente de CoordinaciÃ³n de Citas y Reservas
# VersiÃ³n: 1.0.0 | Fecha: 2025-09-04

flow_name: "intelligent_scheduling_system"
flow_type: "core_functionality"
priority: "highest"
language: "es-LATAM"

# ========================================
# TRIGGERS DE ACTIVACIÃ“N
# ========================================
activation_triggers:
  primary_keywords: ["agendar", "cita", "reserva", "appointment", "programar"]
  secondary_keywords: ["doctor", "dentista", "peluquerÃ­a", "restaurante", "reuniÃ³n"]
  intent_patterns:
    - "schedule_appointment_request"
    - "booking_assistance_needed"
    - "calendar_coordination"
    - "service_provider_contact"

# ========================================
# CATEGORIZACIÃ“N DE TIPOS DE CITAS
# ========================================
appointment_categories:
  
  # CITAS MÃ‰DICAS
  medical_appointments:
    
    subtypes:
      general_doctor:
        keywords: ["doctor general", "mÃ©dico", "consulta", "checkup"]
        typical_duration: "30-60 minutes"
        advance_booking: "1-2 weeks"
        preparation_needed: ["documentos mÃ©dicos", "lista sÃ­ntomas", "estudios previos"]
        
      specialists:
        dentist:
          keywords: ["dentista", "dental", "dientes"]
          preparation: ["no comer 1h antes si hay procedimiento"]
          follow_up: ["cuidados post-consulta"]
          
        gynecologist:
          keywords: ["ginecÃ³logo", "ginecÃ³loga", "revisiÃ³n femenina"]
          preparation: ["fecha Ãºltima menstruaciÃ³n", "estudios previos"]
          privacy_note: "confidential_handling"
          
        dermatologist:
          keywords: ["dermatÃ³logo", "piel", "lunares"]
          preparation: ["no usar cremas dÃ­a anterior", "lista de medicamentos"]
          
        psychologist:
          keywords: ["psicÃ³logo", "terapia", "sesiÃ³n"]
          preparation: ["temas a tratar", "estado emocional actual"]
          follow_up: ["frecuencia sesiones"]

  # SERVICIOS PERSONALES
  personal_services:
    
    beauty_wellness:
      hair_salon:
        keywords: ["peluquerÃ­a", "corte", "pelo", "tinte", "peinado"]
        duration_options: ["corte (1h)", "tinte (2-3h)", "peinado evento (1.5h)"]
        advance_booking: "3-7 days"
        
      barbershop:
        keywords: ["barberÃ­a", "corte masculino", "barba"]
        typical_duration: "30-45 minutes"
        advance_booking: "1-3 days"
        
      spa_massage:
        keywords: ["spa", "masaje", "relajaciÃ³n", "facial"]
        duration_options: ["30min", "60min", "90min", "paquete completo"]
        
    home_services:
      cleaning:
        keywords: ["limpieza", "empleada domÃ©stica", "aseo"]
        scheduling_notes: ["estar presente", "dejar llaves", "dar instrucciones"]
        
      maintenance:
        plumber:
          keywords: ["plomero", "tuberÃ­a", "agua", "baÃ±o"]
          urgency_levels: ["emergencia", "programado", "mantenimiento"]
          
        electrician:
          keywords: ["electricista", "luz", "instalaciÃ³n elÃ©ctrica"]
          safety_priority: "high"

  # RESERVAS SOCIALES
  social_bookings:
    
    restaurants:
      fine_dining:
        keywords: ["restaurante", "cena", "almuerzo", "reserva mesa"]
        information_needed: ["fecha", "hora", "nÃºmero personas", "ocasiÃ³n especial"]
        advance_booking: "1-7 days depending on restaurant"
        
      casual_dining:
        keywords: ["lugar casual", "comida rÃ¡pida", "cafeterÃ­a"]
        booking_flexibility: "usually same day possible"
        
    events_entertainment:
      movies:
        keywords: ["cine", "pelÃ­cula", "funciÃ³n"]
        booking_process: "app assistance or ticket selection"
        
      concerts_shows:
        keywords: ["concierto", "obra", "show", "evento"]
        advance_planning: "weeks to months ahead"

  # REUNIONES PROFESIONALES
  business_meetings:
    
    client_meetings:
      keywords: ["reuniÃ³n cliente", "junta", "presentaciÃ³n"]
      preparation_intensive: ["agenda", "documentos", "presentaciÃ³n"]
      follow_up_required: "always"
      
    team_meetings:
      keywords: ["reuniÃ³n equipo", "staff meeting", "colaboradores"]
      scheduling_complexity: "coordinate multiple calendars"
      
    interviews:
      keywords: ["entrevista", "interview", "candidato"]
      preparation_critical: ["CV review", "questions prepared", "logistics"]

# ========================================
# FLUJO PRINCIPAL DE AGENDAMIENTO
# ========================================
scheduling_workflow:
  
  # PASO 1: IDENTIFICACIÃ“N Y CATEGORIZACIÃ“N
  step_1_identification:
    
    category_detection:
      automatic_categorization: "analyze_keywords_and_context"
      
      confirmation_message: |
        ğŸ“… **Â¡Perfecto! Te ayudo a agendar.**
        
        DetectÃ© que necesitas: **{detected_category}**
        
        Â¿Es correcto o es algo diferente?
        
      category_options_if_unclear:
        - text: "ğŸ¥ Cita mÃ©dica"
          category: "medical"
        - text: "âœ‚ï¸ Servicio personal"
          category: "personal_service"
        - text: "ğŸ½ï¸ Reserva restaurant"
          category: "restaurant"
        - text: "ğŸ’¼ ReuniÃ³n trabajo"
          category: "business"
        - text: "ğŸ“ Otro tipo"
          category: "custom"

  # PASO 2: RECOLECCIÃ“N DE INFORMACIÃ“N
  step_2_information_gathering:
    
    essential_information:
      
      # INFORMACIÃ“N BÃSICA UNIVERSAL
      basic_info_collection:
        when_needed: "Â¿Para cuÃ¡ndo necesitas la cita?"
        duration_preference: "Â¿Tienes preferencia de horario? (maÃ±ana/tarde)"
        urgency_level: "Â¿QuÃ© tan urgente es? (hoy/esta semana/flexible)"
        
      # INFORMACIÃ“N ESPECÃFICA POR CATEGORÃA
      category_specific_info:
        
        medical_specific:
          provider_preference: |
            ğŸ¥ **Para tu cita mÃ©dica:**
            â€¢ Â¿Tienes doctor/dentista de preferencia?
            â€¢ Â¿Es consulta de rutina o algo especÃ­fico?
            â€¢ Â¿Necesitas que busque opciones cerca de ti?
            
          insurance_considerations: "Â¿Tu seguro cubre este tipo de consulta?"
          
        personal_service_specific:
          service_details: |
            âœ‚ï¸ **Para tu servicio personal:**
            â€¢ Â¿QuÃ© servicio especÃ­fico necesitas?
            â€¢ Â¿Tienes lugar/persona de confianza?
            â€¢ Â¿Presupuesto aproximado?
            
        restaurant_specific:
          dining_details: |
            ğŸ½ï¸ **Para tu reserva:**
            â€¢ Â¿Para cuÃ¡ntas personas?
            â€¢ Â¿QuÃ© tipo de comida prefieres?
            â€¢ Â¿Zona/ubicaciÃ³n especÃ­fica?
            â€¢ Â¿Presupuesto por persona?
            â€¢ Â¿OcasiÃ³n especial?

  # PASO 3: BÃšSQUEDA Y COORDINACIÃ“N
  step_3_coordination:
    
    # BÃšSQUEDA DE OPCIONES
    option_research:
      
      provider_search_strategy:
        user_has_preference:
          process: "verify_contact_info_and_availability"
          message: |
            ğŸ“ **Contactando a {preferred_provider}:**
            
            Te ayudo a coordinar con ellos:
            â€¢ Verifico su informaciÃ³n de contacto
            â€¢ Te doy script para llamar/mensaje
            â€¢ Te ayudo a confirmar disponibilidad
            
        user_needs_options:
          search_criteria: ["location", "ratings", "price_range", "availability"]
          results_presentation: |
            ğŸ” **EncontrÃ© {number} opciones excelentes:**
            
            {option_list_with_details}
            
            Â¿Con cuÃ¡l te gustarÃ­a que te ayude a coordinar?

    # ASISTENCIA EN CONTACTO
    contact_assistance:
      
      phone_call_preparation:
        script_provision: |
          ğŸ“ **Script para tu llamada:**
          
          "Hola, quisiera agendar una cita para {service_type}.
          Â¿Tienen disponibilidad {preferred_timeframe}?
          {additional_specific_requirements}"
          
          **InformaciÃ³n a confirmar:**
          â€¢ Fecha y hora exacta
          â€¢ Costo del servicio
          â€¢ QuÃ© necesitas llevar
          â€¢ DirecciÃ³n exacta
          â€¢ TelÃ©fono de contacto
          
        post_call_follow_up: "Â¿CÃ³mo te fue? Â¿Necesitas que programe recordatorios?"
        
      digital_booking_assistance:
        app_guidance: "Te guÃ­o paso a paso para reservar por la app/web"
        form_completion_help: "Te ayudo a completar formularios online"

  # PASO 4: CONFIRMACIÃ“N Y PROGRAMACIÃ“N
  step_4_confirmation:
    
    appointment_confirmation:
      
      details_verification: |
        âœ… **ConfirmaciÃ³n de tu cita:**
        
        ğŸ“‹ **Servicio:** {service_type}
        ğŸ‘¤ **Proveedor:** {provider_name}
        ğŸ“… **Fecha:** {appointment_date}
        ğŸ• **Hora:** {appointment_time}
        ğŸ“ **Lugar:** {location}
        ğŸ’° **Costo:** {cost_if_available}
        
        Â¿Todo correcto?
        
      confirmation_options:
        - text: "âœ… Perfecto"
          action: "finalize_appointment"
        - text: "ğŸ“ Cambiar algo"
          action: "modify_details"
        - text: "ğŸ“ Llamar para confirmar"
          action: "provide_contact_script"

    # PROGRAMACIÃ“N DE RECORDATORIOS
    reminder_setup:
      
      automatic_reminders:
        reminder_schedule:
          advance_confirmation: "24 hours before - confirm attendance"
          preparation_reminder: "2 hours before - gather documents/prepare"
          departure_reminder: "time_to_leave considering traffic"
          
        reminder_message_template: |
          ğŸ”” **Recordatorio de cita:**
          
          {service_type} con {provider}
          ğŸ“… {date} a las {time}
          ğŸ“ {location}
          
          {specific_preparation_notes}
          
          Â¿Todo listo o necesitas ayuda con algo?

# ========================================
# GESTIÃ“N AVANZADA DE CITAS
# ========================================
advanced_scheduling:
  
  # DETECCIÃ“N Y RESOLUCIÃ“N DE CONFLICTOS
  conflict_management:
    
    calendar_integration:
      conflict_detection: |
        âš ï¸ **Posible conflicto detectado:**
        
        ğŸ”” **Nueva cita:** {new_appointment}
        ğŸ“… **Evento existente:** {existing_event}
        â° **Conflicto en:** {conflict_time}
        
        Â¿CÃ³mo resolvemos esto?
        
      resolution_options:
        - text: "ğŸ“… Mover nueva cita"
          action: "reschedule_new_appointment"
        - text: "ğŸ”„ Cambiar evento existente"
          action: "modify_existing_event"
        - text: "â° Buscar horario alternativo"
          action: "find_alternative_time"
        - text: "âœ… Mantener ambos (lo manejo yo)"
          action: "accept_tight_schedule"

  # COORDINACIÃ“N MULTI-PERSONA
  group_scheduling:
    
    multiple_attendees:
      coordination_process: |
        ğŸ‘¥ **CoordinaciÃ³n grupal para {event_type}:**
        
        ğŸ¯ **Participantes:** {attendee_list}
        ğŸ“… **Opciones de fecha:** {date_options}
        
        Te ayudo a encontrar el horario que funcione para todos.
        
      polling_system:
        availability_check: "Send availability poll to all attendees"
        consensus_building: "Find optimal time based on responses"
        final_confirmation: "Confirm with all parties once decided"

  # REAGENDAMIENTO Y CANCELACIONES
  rescheduling_system:
    
    modification_requests:
      user_initiated_changes:
        change_request_processing: |
          ğŸ”„ **Cambio de cita solicitado:**
          
          ğŸ“… **Cita actual:** {current_appointment}
          ğŸ”„ **Cambio necesario:** {change_reason}
          
          Te ayudo a coordinar el cambio:
          
        rescheduling_assistance:
          - "Contact provider to explain change"
          - "Find new available time slot"
          - "Update all related reminders"
          - "Confirm new arrangement"

    emergency_cancellations:
      urgent_cancellation_support: |
        ğŸš¨ **CancelaciÃ³n de emergencia:**
        
        Te ayudo inmediatamente:
        â€¢ Contacto rÃ¡pido al proveedor
        â€¢ Mensaje profesional explicando situaciÃ³n
        â€¢ Reagendamiento prioritario si necesitas
        â€¢ ActualizaciÃ³n de recordatorios
        
      cancellation_etiquette:
        professional_message_template: |
          "Disculpe, necesito cancelar mi cita de {date} a las {time} 
          por {brief_reason}. Â¿PodrÃ­amos reagendar para {alternative_timeframe}? 
          Gracias por su comprensiÃ³n."

# ========================================
# PREPARACIÃ“N Y SEGUIMIENTO
# ========================================
appointment_lifecycle:
  
  # PREPARACIÃ“N PRE-CITA
  pre_appointment_preparation:
    
    customized_preparation:
      
      medical_appointment_prep:
        document_checklist: |
          ğŸ“‹ **Para tu cita mÃ©dica:**
          
          âœ… **Documentos necesarios:**
          â€¢ IdentificaciÃ³n oficial
          â€¢ Tarjeta del seguro mÃ©dico
          â€¢ Estudios/anÃ¡lisis previos
          â€¢ Lista de medicamentos actuales
          
          âœ… **InformaciÃ³n a recordar:**
          â€¢ SÃ­ntomas especÃ­ficos y cuÃ¡ndo empezaron
          â€¢ Preguntas para el doctor
          â€¢ Cambios en tu salud desde Ãºltima visita
          
        logistics_reminder: |
          ğŸš— **LogÃ­stica:**
          â€¢ Salir a las {departure_time} (considerando trÃ¡fico)
          â€¢ Estacionamiento: {parking_info}
          â€¢ Llegar 15 min antes para registro
          
      business_meeting_prep:
        professional_preparation: |
          ğŸ’¼ **Para tu reuniÃ³n profesional:**
          
          ğŸ“Š **PreparaciÃ³n necesaria:**
          â€¢ Agenda de temas a tratar
          â€¢ Documentos/presentaciones listas
          â€¢ Objetivos claros de la reuniÃ³n
          â€¢ Material de apoyo impreso
          
          ğŸ‘” **Detalles logÃ­sticos:**
          â€¢ Dress code: {dress_code}
          â€¢ UbicaciÃ³n exacta: {detailed_location}
          â€¢ Contacto en caso de emergencia: {contact_info}

  # SEGUIMIENTO POST-CITA
  post_appointment_follow_up:
    
    automatic_check_in:
      follow_up_timing: "2 hours after scheduled end time"
      
      check_in_message: |
        ğŸ˜Š **Â¿CÃ³mo te fue en tu {appointment_type}?**
        
        Espero que todo haya salido excelente.
        
        Â¿Necesitas:
        â€¢ Programar seguimiento o prÃ³xima cita?
        â€¢ Recordatorios para indicaciones recibidas?
        â€¢ Ayuda con algo relacionado?
        
    outcome_processing:
      
      medical_follow_up:
        next_steps_management: |
          ğŸ¥ **Seguimiento mÃ©dico:**
          
          Â¿El doctor te dio:
          â€¢ Nuevos medicamentos? (programo recordatorios)
          â€¢ Estudios pendientes? (ayudo a agendar)
          â€¢ PrÃ³xima cita? (la agrego a tu calendario)
          â€¢ Indicaciones especiales? (recordatorios personalizados)
          
      service_satisfaction:
        quality_check: "Â¿Quedaste satisfecho con el servicio?"
        provider_rating: "Â¿RecomendarÃ­as este lugar para futuras referencias?"
        improvement_notes: "Â¿Algo que deba considerar para prÃ³ximas citas similares?"

# ========================================
# INTEGRACIONES INTELIGENTES
# ========================================
smart_integrations:
  
  # INTEGRACIÃ“N CON CALENDARIO
  calendar_sync:
    
    automatic_calendar_entry:
      event_creation: |
        ğŸ“… **Agregando a tu calendario:**
        
        ğŸ“ **TÃ­tulo:** {appointment_title}
        ğŸ• **Hora:** {start_time} - {end_time}
        ğŸ“ **UbicaciÃ³n:** {location_with_address}
        ğŸ“ **Notas:** {preparation_notes}
        
        âœ… **Sincronizado con Google Calendar**
        
    travel_time_calculation:
      intelligent_scheduling: |
        ğŸš— **CÃ¡lculo inteligente de tiempo:**
        
        ğŸ“ **Desde:** {current_location}
        ğŸ“ **Hasta:** {appointment_location}
        ğŸ• **Tiempo estimado:** {travel_time}
        â° **Hora de salida sugerida:** {departure_time}
        
        (Incluyendo tiempo de estacionamiento y registro)

  # INTEGRACIÃ“N CON PROVEEDORES
  provider_integration:
    
    business_directory_connection:
      information_enrichment:
        - "Real-time availability checking"
        - "Current pricing information"
        - "Customer reviews and ratings"
        - "Special offers or promotions"
        
    booking_platform_integration:
      direct_booking_capability: |
        ğŸ’» **Reserva directa disponible:**
        
        Puedo hacer la reserva directamente a travÃ©s de:
        â€¢ OpenTable (restaurantes)
        â€¢ Calendly (profesionales)
        â€¢ App del proveedor
        
        Â¿Prefieres que reserve yo o te guÃ­o para hacerlo?

# ========================================
# CASOS ESPECIALES Y MANEJO DE ERRORES
# ========================================
special_scenarios:
  
  # SITUACIONES URGENTES
  urgent_scheduling:
    
    emergency_appointments:
      immediate_need_detection:
        keywords: ["urgente", "emergencia", "hoy mismo", "ya", "inmediato"]
        
      urgent_response_protocol: |
        ğŸš¨ **SituaciÃ³n urgente detectada:**
        
        Entiendo que necesitas {service_type} urgentemente.
        
        **Acciones inmediatas:**
        1. Busco opciones de emergencia/citas del dÃ­a
        2. Te doy contactos directos para llamar
        3. Te ayudo con mensaje urgente pero profesional
        4. Coordino todo lo necesario en paralelo
        
        Â¿Es una emergencia mÃ©dica? Si es grave, ve al hospital.
        
    same_day_booking:
      availability_search: "Focus on providers with same-day availability"
      persistence_strategy: "Multiple contact attempts with urgency emphasis"

  # PROVEEDORES NO DISPONIBLES
  unavailability_management:
    
    fully_booked_scenarios:
      alternative_strategy: |
        ğŸ˜” **Tu primera opciÃ³n estÃ¡ llena, pero no te preocupes:**
        
        ğŸ¯ **Plan B activado:**
        â€¢ Te busco alternativas igual de buenas
        â€¢ Pregunto por lista de espera/cancelaciones
        â€¢ Coordino para fechas futuras disponibles
        â€¢ Te doy opciones en ubicaciones cercanas
        
        Â¿Prefieres esperar o exploramos otras opciones?
        
    provider_unresponsive:
      backup_coordination: |
        ğŸ“ **Proveedor no responde - activando backup:**
        
        â€¢ Intento diferentes mÃ©todos de contacto
        â€¢ Busco proveedores alternativos similar calidad
        â€¢ Te mantengo informado del progreso
        â€¢ Aseguro que tengas cita confirmada hoy
        
        Mi compromiso: no quedas sin tu cita programada.

# ========================================
# PERSONALIZACIÃ“N Y APRENDIZAJE
# ========================================
personalization_system:
  
  # PREFERENCIAS DE USUARIO
  user_preference_learning:
    
    behavioral_pattern_recognition:
      scheduling_preferences:
        - "Preferred time slots (morning vs afternoon vs evening)"
        - "Advance booking tendency (last minute vs well planned)"
        - "Provider loyalty (stick to favorites vs try new places)"
        - "Communication style preference (phone vs message vs app)"
        
    preference_adaptation:
      automatic_suggestions: |
        ğŸ’¡ **Basado en tu historial:**
        
        NotÃ© que prefieres {identified_pattern}.
        Â¿Para esta cita tambiÃ©n prefieres {suggested_approach}?
        
      preference_confirmation: "Â¿Esta sugerencia es Ãºtil o prefieres diferente?"

  # MEJORA CONTINUA
  continuous_improvement:
    
    success_pattern_analysis:
      - "Which scheduling approaches work best for this user"
      - "Optimal timing for different types of appointments"
      - "Most successful provider recommendations"
      - "Effective reminder timing and frequency"
      
    adaptation_implementation:
      - "Adjust default suggestions based on success patterns"
      - "Personalize communication style and formality"
      - "Optimize reminder timing for individual response patterns"
      - "Improve provider recommendations based on satisfaction"

# ========================================
# MÃ‰TRICAS Y ANÃLISIS
# ========================================
analytics_framework:
  
  # MÃ‰TRICAS DE Ã‰XITO
  success_metrics:
    appointment_completion_rate: "Percentage of scheduled appointments that actually happen"
    user_satisfaction_scores: "Post-appointment satisfaction ratings"
    booking_efficiency: "Time from request to confirmed appointment"
    conflict_resolution_success: "How well conflicts are resolved"
    
  # ANÃLISIS DE RENDIMIENTO
  performance_analysis:
    provider_success_rates: "Which providers consistently deliver good experiences"
    optimal_scheduling_patterns: "Best times and methods for different appointment types"
    user_engagement_patterns: "How users interact with scheduling features"
    
  # OPTIMIZACIÃ“N CONTINUA
  optimization_opportunities:
    - "Improve provider recommendation algorithm"
    - "Enhance conflict detection and resolution"
    - "Optimize reminder timing and content"
    - "Streamline information gathering process"

# Fin del flujo de agendamiento